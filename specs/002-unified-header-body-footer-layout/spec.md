# Feature Specification: 统一页面 Header 布局样式

**Feature Branch**: `002-unified-header-body-footer-layout`  
**Created**: 2026-01-30  
**Status**: Draft  
**Input**: User description: "统一所有的页面的header布局样式。全部都是左边显示app名称，右边是登录状态。"

## Clarifications

### Session 2026-01-31

- Q: 点击 Header 左侧的应用名称应该触发什么行为？ → A: 跳转到首页（今日餐单页面）
- Q: 点击用户头像后显示的菜单应该包含哪些具体选项？ → A: 退出登录、个人设置、切换宝宝（如果有多个宝宝）
- Q: 当网络不稳定导致登录状态加载失败时，Header 右侧应该如何处理？ → A: 显示最后已知状态 + 重试按钮（点击后重新获取登录状态）
- Q: 当用户处于登录页面时，Header 右侧应该显示什么？ → A: 显示"注册"按钮
- Q: 当用户只有一个宝宝时，用户菜单中是否应该显示"切换宝宝"选项？ → A: 始终显示（但点击后提示"当前只有一个宝宝"）

## User Scenarios & Testing *(mandatory)*

### User Story 1 - 统一 Header 布局显示 (Priority: P1)

用户在使用应用的所有页面时，能够在页面顶部看到统一的 Header 布局：左侧显示应用名称，右侧显示登录状态（用户头像或登录按钮）。

**Why this priority**: 这是用户体验的基础，统一的 Header 布局让用户在任何页面都能快速识别应用品牌和自己的登录状态，提升应用的辨识度和一致性。

**Independent Test**: 可以通过浏览应用的所有页面（今日餐单、食谱管理、计划管理、宝宝档案、体检记录、生长曲线、仓库管理、AI 设置、登录、注册等），验证每个页面的 Header 都遵循相同的布局：左侧应用名称，右侧登录状态。

**Acceptance Scenarios**:

1. **Given** 用户打开应用的任意页面，**When** 页面加载完成，**Then** 页面顶部显示固定的 Header，左侧显示应用名称 "BabyFood"，右侧显示登录状态
2. **Given** 用户已登录应用，**When** 观察任意页面的 Header 右侧，**Then** 显示用户头像或用户名
3. **Given** 用户未登录应用，**When** 观察任意页面的 Header 右侧，**Then** 显示"登录"按钮
4. **Given** 用户在任意页面，**When** 观察 Header 左侧，**Then** 应用名称 "BabyFood" 的字体、颜色、大小在所有页面中保持一致
5. **Given** 用户点击 Header 右侧的登录按钮，**Then** 跳转到登录页面
6. **Given** 用户点击 Header 右侧的用户头像，**Then** 显示用户菜单或跳转到用户设置页面

---

### User Story 2 - Header 响应式适配 (Priority: P2)

用户在不同尺寸的设备上使用应用时，Header 布局能够自动适配屏幕尺寸，确保应用名称和登录状态都清晰可见。

**Why this priority**: 支持不同屏幕尺寸的设备确保了 Header 在所有设备上都能正常显示，避免内容被截断或重叠。

**Independent Test**: 可以在不同屏幕尺寸的模拟器或真机上测试应用，验证 Header 能够正确适配各种屏幕尺寸，应用名称和登录状态都完整显示。

**Acceptance Scenarios**:

1. **Given** 用户在小屏幕设备上使用应用，**When** 打开任意页面，**Then** Header 高度自动适配，应用名称和登录状态都完整显示
2. **Given** 用户在大屏幕设备上使用应用，**When** 打开任意页面，**Then** Header 宽度自动适配，应用名称居左对齐，登录状态居右对齐
3. **Given** 用户旋转设备屏幕方向，**When** 页面重新布局，**Then** Header 正确适配新的屏幕方向，应用名称和登录状态位置正确

---

### User Story 3 - Header 交互行为 (Priority: P3)

用户与 Header 中的元素交互时，能够获得一致的反馈和行为。

**Why this priority**: 一致的交互行为让用户能够预测 Header 元素的功能，减少困惑和误操作。

**Independent Test**: 可以通过点击 Header 中的登录按钮和用户头像，验证交互行为是否一致且正确。

**Acceptance Scenarios**:

1. **Given** 用户点击 Header 右侧的登录按钮，**When** 点击完成，**Then** 跳转到登录页面
2. **Given** 用户点击 Header 右侧的用户头像，**When** 点击完成，**Then** 显示下拉菜单（包含退出登录、个人设置、切换宝宝选项）
3. **Given** 用户只有一个宝宝，**When** 点击"切换宝宝"选项，**Then** 显示提示"当前只有一个宝宝"
4. **Given** 用户点击 Header 左侧的应用名称，**When** 点击完成，**Then** 跳转到首页（今日餐单页面）
5. **Given** 用户在 Header 上进行触摸操作，**Then** Header 元素有明确的视觉反馈（如点击高亮、颜色变化等）

---

### Edge Cases

- 当应用名称过长时，Header 左侧如何显示？
  - **决策**：应用名称固定为 "BabyFood"，长度可控，不需要截断
- 当用户名过长时，Header 右侧如何显示？
  - **决策**：显示用户头像，不显示用户名，避免截断问题
- 当网络不稳定导致登录状态加载失败时，Header 右侧如何显示？
  - **决策**：显示最后已知状态 + 重试按钮（点击后重新获取登录状态）
- 当用户处于登录页面时，Header 右侧是否仍显示登录按钮？
  - **决策**：登录页面的 Header 右侧显示"注册"按钮
- 当用户处于注册页面时，Header 右侧是否仍显示登录按钮？
  - **决策**：注册页面的 Header 右侧显示"登录"按钮
- 当用户只有一个宝宝时，用户菜单中的"切换宝宝"选项如何显示？
  - **决策**：始终显示，但点击后提示"当前只有一个宝宝"

## Requirements *(mandatory)*

### Functional Requirements

- **FR-001**: 系统必须为所有页面提供统一的 Header 布局
- **FR-002**: 系统必须在 Header 左侧显示应用名称 "BabyFood"
- **FR-003**: 系统必须在 Header 右侧显示登录状态
- **FR-004**: 系统必须在用户已登录时，Header 右侧显示用户头像或用户标识
- **FR-005**: 系统必须在用户未登录时，Header 右侧显示"登录"按钮
- **FR-006**: 系统必须在所有页面中保持一致的 Header 样式（高度、颜色、字体、间距）
- **FR-007**: 系统必须确保 Header 固定在页面顶部，不随内容滚动
- **FR-008**: 系统必须支持 Header 响应式布局，自动适配不同屏幕尺寸
- **FR-009**: 系统必须在屏幕方向改变时自动重新布局 Header
- **FR-010**: 系统必须在用户点击 Header 右侧的登录按钮时，跳转到登录页面
- **FR-011**: 系统必须在用户点击 Header 右侧的用户头像时，显示用户菜单
- **FR-012**: 用户菜单必须包含退出登录、个人设置、切换宝宝（如果有多个宝宝）选项
- **FR-013**: 系统必须在用户点击 Header 左侧的应用名称时，跳转到首页（今日餐单页面）
- **FR-014**: 系统必须提供可复用的 Header 组件，便于统一维护和修改
- **FR-015**: 系统必须为 Header 中的所有交互元素提供屏幕阅读器内容标签
- **FR-016**: 系统必须支持键盘导航，Header 中的可交互元素可通过 Tab 键访问
- **FR-017**: 系统必须支持高对比度模式，确保 Header 文字和背景对比度符合 WCAG AA 标准（至少 4.5:1）
- **FR-018**: 系统必须支持动态字体大小，Header 能够适配系统字体大小设置
- **FR-019**: 系统必须确保 Header 中所有触摸目标（按钮、头像等）的最小尺寸为 48dp
- **FR-020**: 系统必须为 Header 提供语义化描述，辅助技术用户能够理解 Header 的结构和功能
- **FR-021**: 系统必须在网络不稳定导致登录状态加载失败时，显示最后已知状态和重试按钮
- **FR-022**: 系统必须在用户点击重试按钮时，重新获取登录状态并更新 Header 显示
- **FR-023**: 系统必须在用户处于登录页面时，Header 右侧显示"注册"按钮
- **FR-024**: 系统必须在用户处于注册页面时，Header 右侧显示"登录"按钮
- **FR-025**: 系统必须在用户点击 Header 右侧的注册按钮时，跳转到注册页面
- **FR-026**: 用户菜单中的"切换宝宝"选项必须始终显示
- **FR-027**: 系统必须在用户只有一个宝宝时点击"切换宝宝"选项，显示提示"当前只有一个宝宝"

### Key Entities *(include if feature involves data)*

- **Header 配置**：定义 Header 的应用名称、登录状态显示逻辑、交互行为等配置信息
- **Header 组件**：可复用的 Header 布局组件，包含应用名称显示和登录状态显示

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: 所有页面（至少 10 个主要页面）都显示统一的 Header 布局
- **SC-002**: Header 组件代码复用率达到 100%（所有页面使用同一个 Header 组件）
- **SC-003**: 用户在不同页面中看到 Header 的一致性满意度达到 90% 以上（通过用户测试评估）
- **SC-004**: Header 在不同屏幕尺寸下的适配率达到 100%（支持应用支持的所有屏幕尺寸）
- **SC-005**: Header 在屏幕方向改变时的响应时间小于 0.5 秒
- **SC-006**: Header 的维护成本降低 80%（通过统一修改 Header 组件实现全局更新）
- **SC-007**: Header 中登录状态的显示准确率达到 100%（已登录显示头像，未登录显示登录按钮）

## Assumptions

- 应用使用 Jetpack Compose 构建 UI
- 应用使用 Material Design 3 设计规范
- 应用支持 Android 7.0 (API 24) 及以上版本
- 应用支持竖屏和横屏两种屏幕方向
- 应用的主要页面包括：今日餐单、食谱管理、计划管理、宝宝档案、体检记录、生长曲线、仓库管理、AI 设置、登录、注册等
- 应用已有用户认证系统，能够判断用户登录状态

## Dependencies

- 依赖现有的页面 UI 组件（需要集成统一 Header）
- 依赖现有的用户认证系统（需要获取登录状态）
- 依赖现有的主题配置（需要统一 Header 样式）
- 依赖现有的导航系统（需要适配 Header 中的登录按钮跳转）